#!/bin/bash
if [ "$#" -ne 3 ]; then
	echo "Usage: ./launch_enum_attacks.sh IP PORT DomainName"
	exit
fi

echo "This program requires sudo rights."
echo "Dont forget to add domain name to your /etc/hosts file"

echo "Starting attacks..."

echo "----------------------------------"
echo "          Port scanning           "
echo "----------------------------------"
sudo nmap -sCV $1

echo "----------------------------------"
echo "     Website pages enumeration    "
echo "----------------------------------"
gobuster dir -u $1:$2 -w /usr/share/wordlists/dirb/big.txt
# we could use dirb too
#dirb http://$1

echo "----------------------------------"
echo "      Subdomains enumeration      "
echo "----------------------------------"
echo "Getting size of default response..."
lines=$(curl "http://$1:$2/" -b "Host: test.$1:$2" 2>/dev/null | wc -l)
wfuzz --hl "$lines" -c -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -u "http://$1" -H "Host: FUZZ.$3" 2> /dev/null
